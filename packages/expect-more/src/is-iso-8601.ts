import { isString } from './is-string';
import { isValidDate } from './is-valid-date';

export const isIso8601 = (value: any) => {
  // '1999-12-31'
  // '1999-12-31T23:59'
  // '1999-12-31T23:59:59'
  // '1999-12-31T23:59:59.000'
  // '1999-12-31T23:59:59.000Z'
  return (
    isString(value) &&
    (/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/.test(value) ||
      /^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})$/.test(value) ||
      /^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})$/.test(value) ||
      /^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})\.([0-9]{3})$/.test(value) ||
      /^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})\.([0-9]{3})Z$/.test(value)) &&
    isValidDate(new Date(value))
  );
};
